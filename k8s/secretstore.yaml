# DEC-034: SecretStore template for External Secrets Operator (ESO).
# Configures the backend provider that supplies secret values.
#
# This is a TEMPLATE â€” you must configure a provider before applying.
# See docs/RUNBOOK_SECRETS.md for provider-specific setup instructions.
#
# Supported providers (configure ONE):
#   - AWS Secrets Manager
#   - HashiCorp Vault
#   - GCP Secret Manager
#   - Azure Key Vault
#   - Kubernetes (for dev/test only)
apiVersion: external-secrets.io/v1beta1
kind: SecretStore
metadata:
  name: cryptoscreener-store
  labels:
    app: cryptoscreener
    app.kubernetes.io/name: cryptoscreener
    app.kubernetes.io/component: pipeline
    app.kubernetes.io/part-of: cryptoscreener-x
spec:
  provider:
    # === AWS Secrets Manager (uncomment and configure) ===
    # aws:
    #   service: SecretsManager
    #   region: ap-northeast-1
    #   auth:
    #     secretRef:
    #       accessKeyIDSecretRef:
    #         name: aws-credentials
    #         key: access-key-id
    #       secretAccessKeySecretRef:
    #         name: aws-credentials
    #         key: secret-access-key

    # === HashiCorp Vault (uncomment and configure) ===
    # vault:
    #   server: "https://vault.example.com"
    #   path: "secret"
    #   version: "v2"
    #   auth:
    #     kubernetes:
    #       mountPath: "kubernetes"
    #       role: "cryptoscreener"

    # === Fake / Kubernetes backend (dev/test only) ===
    # Use this for local development when no external backend is available.
    # Create a regular K8s secret with the values, then ESO reads from it.
    kubernetes:
      auth:
        serviceAccount:
          name: default
      server:
        caProvider:
          type: ConfigMap
          name: kube-root-ca.crt
          key: ca.crt
