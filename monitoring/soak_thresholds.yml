# DEC-032: Nightly soak regression thresholds.
# Used by scripts/check_soak_thresholds.py to gate CI.

baseline:
  # No events should be dropped under normal load
  events_dropped_max: 0
  snapshots_dropped_max: 0
  # Queue depth should stay well below cap (10,000)
  max_event_queue_depth: 2000
  max_snapshot_queue_depth: 500
  # RSS should stay reasonable
  max_rss_mb: 200
  # Tick drift max includes one-time startup spike (WS connect + bootstrap).
  # Steady-state drift is <<1000ms; startup can spike to ~5-6s.
  max_tick_drift_ms: 10000
  # Reconnect rate per shard (DEC-027 acceptance: <= 6.0)
  max_reconnect_rate_per_min: 6.0

overload:
  # Under overload, drops MUST occur (backpressure engaged).
  # Overload params (200ms slow consumer, 1ms send, 20 symbols) reliably saturate the queue.
  events_dropped_min: 1
  # Queue depth should stay at cap, not exceed it
  max_event_queue_depth: 10000
  max_snapshot_queue_depth: 1000
  # RSS under overload
  max_rss_mb: 300
  # Tick drift includes startup spike + consumer delay overhead
  max_tick_drift_ms: 10000
  # Reconnect rate still bounded
  max_reconnect_rate_per_min: 6.0
